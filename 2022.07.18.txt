# 运输层

​		运输层向上承接来自应用层的数据，将来自应用层的报文划分为块，并为每块添加一个运输层首部生成运输层报文段；向下传递运输层报文段，交给网络层，网络层将其封装为网络层分组（数据报）向目的地发送

​		两种运输层协议：TCP、UDP

## 一、运输层服务

### 1.网络层和运输层的关系

- 运输层提供主机进程之间的逻辑通信，网络层提供主机之间的逻辑通信

- 运输层只工作在端系统上，其只负责将应用层的报文移动到网络的边缘（网络层），对于数据在网路核心中如何移动并不关心；同时中间路由器也不关心运输层加在应用层报文的任何信息
- 运输层能够提供的服务受制于网络层协议。假如网络层没法保证主机之间的运输层报文段的时延和带宽，那么运输层也就无法为进程之间发送的应用程序报文提供时延和带宽保证

2.多路复用与多路分解

多路分解：将运输层报文段中的数据交付到正确套接字的过程

多路复用：从不同套接字中收集数据块，并为每个数据块封装首部信息生成报文段，然后将报文段发送到网络层

无连接的多路复用和多路分解：

- UDP套接字由一个二元组全面标识（目的IP地址和端口号），因此即使报文段来自不同的源IP和端口，只要它们具有相同的目的IP地址和端口号，目的主机最终会以同一个套接字将数据块传送给应用进程

面向连接的多路复用和多路分解：

- 不同于UDP，TCP套接字需要四元组全面标识（源和目的IP地址及端口号），因此上述UDP的情况对于TCP连接就不一样，只要源端口和IP地址不同，最终分解到的一定是不同的套接字（除非是一个带有创建连接的字段的TCP报文段）
- 不同套接字不一定就是对应的一个不同进程，服务器可能只有一个进程，但是对于多个链接客户会创建新的子线程（看做轻量级的子进程）