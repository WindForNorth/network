# 应用层

## 一、Web与HTTP

### 1.HTTP概况

- Web的应用层协议即HTTP（超文本传输协议）协议，由客户程序和服务器程序实现；Web页面（也叫文档）由对象组成，一个对象是一个文件（比如HTML文件，JPEG图像等等）

- HTTP协议使用TCP作为其支撑运输协议
- 客户端套接字接口是客户进程和TCP连接之间的门，相应服务器端的套接字就是服务器进程和TCP连接之间的门
- HTTP服务器不保存任何有关客户的信息，因此HTTP是一个**无状态协议**

### 2.持续连接和非持续连接

- 持续连接可以通过单个TCP连接来发送多个文件，经过一定时间未使用此链接就会关闭
- 非持续连接则每次接收/发送都会重新建立新的连接

### 3.HTTP报文格式

- 请求报文

  ```
  请求行--|方法|sp|URL|sp|版本|cr|lf|
  首部行（多行）--|首部字段名:|值|cr|lf|
  空行--|cr|lf|
  实体体--这行在使用POST时使用get方法时没有
  ```

  常见的方法：

  - GET，用于获取资源
  - POST，类似于GET
  - HEAD
  - PUT，向服务器指定路径可以上传对象
  - DELETE，删除服务器指定路径的对象

- 响应报文

  ```
  状态行--|版本|sp|状态码|sp|短语|cr|lf|
  首部行（多行）--|首部字段名:|sp|值|cr|lf|
  空行--|cr|lf|
  实体体--
  ```

  常见的状态码及其短语：

  - 200 OK，表示请求成功，信息在返回的响应报文中
  - 301 Moved Permanently，请求对象被永久转移，新的URL定义在响应报文的Location:首部行中。客户软件将自动获取信息的URL
  - 400 Bad Request，通用差错代码，该请求不能被服务器理解
  - 404 Not Found，被请求的文档不在服务器上
  - 505 HTTP Version NOT Supported，服务器不支持请求报文使用的HTTP协议版本

### 4.用户与服务器的交互：cookie

- cookie的四大组件

  在HTTP响应报文中的一个cookie首部行

  在HTTP请求报文中的一个cookie首部行

  在Web站点后端数据库

  在用户端系统保留cookie文件，由相应的浏览器进行管理

- 当一个用户首次登录一个站点时，即请求报文首次到达此web服务器时，web服务器会产生一个唯一识别码，用于标识此用户，在后端数据库产生一个数据项。
- 当用户之后再次访问此站点时，HTTP请求报文中会自动加上这个cookie。
- 站点通过对用户请求报文中cookie来跟踪客户信息，访问过什么页面在什么时间等等
- 浏览器向服务器传递了cookie首部，服务器得以标识用户，因此可以在无状态的HTTP之上建立一个用户会话层